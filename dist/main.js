(()=>{"use strict";class t{constructor(t,e,s="#000000"){this._x=t,this._y=e,this.color=s}get x(){return this._x}set x(t){if(isNaN(t))throw new Error("Ээээ, чё суёшь"+t);this._x=t}get y(){return this._y}set y(t){if(isNaN(t))throw new Error("Ээээ, чё суёшь"+t);this._y=t}draw(t,e){if(!t)throw Error("ctx undefined");let s=e.color||this.color,i=e.dotSize;t.fillStyle=s,t.fillRect(this.x-i/2,this.y-i/2,i,i)}}class e extends t{constructor(t,e,s,i,h){super(t,e,s),this.mass=h,this.size=i}draw(t,e){super.draw(t,{dotSize:e.dotSize|this.size})}}class s{constructor(t,e){this.from=t,this.to=e}get x(){return this.to.x-this.from.x}get y(){return this.to.y-this.from.y}get length(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}add(e){return new s(this.from,new t(this.to.x+e.x,this.to.y+e.y))}multiply(e){return new s(this.from,new t(this.from.x+this.x*e,this.from.y+this.y*e))}normalize(){return this.multiply(1/this.length)}}class i extends s{constructor(e,s){super(new t(0,0),new t(e,s))}}class h extends e{constructor(t,s,h,r,n){super(t,s,n.color,h,r),this.speed=null,this.centers=[],this.hide=n.hide||!1;let o=n.centers;o&&(o instanceof e?this.centers=[o]:o instanceof Array&&(this.centers=o));let l=n.speed;this.speed=l||new i(0,0)}draw(t,e){this.hide||super.draw(t,{color:this.color,dotSize:this.size})}move(t){this.x+=1*this.speed.x/t,this.y+=1*this.speed.y/t}wallCollision(t,e){(this.x<0||this.x>t)&&(this.speed=new i(-this.speed.x,this.speed.y),this.x<0?(this.x=0,this.speed.x<0&&(this.speed=new i(-this.speed.x,this.speed.y))):this.x>t&&(this.x=t,this.speed.x>0&&(this.speed=new i(-this.speed.x,this.speed.y)))),(this.y<0||this.y>e)&&(this.y<0?(this.y=0,this.speed.y<0&&(this.speed=new i(this.speed.x,-this.speed.y))):this.y>e&&(this.y=e,this.speed.y>0&&(this.speed=new i(this.speed.x,-this.speed.y))))}update(t){for(let e of this.centers){if(e.x===this.x&&e.y===this.y)continue;let i=new s(this,e);if(i.length<e.size)continue;let h=i.normalize().multiply(66743e-19*e.mass/i.length);this.speed=this.speed.add(h.multiply(1/t))}}}const r=document.getElementsByTagName("canvas")[0],n=r.getContext("2d");let o=new class{constructor(t){this.lastFrameEndTime=null,this.pendulums=null,this.pendulums=t.pendulums}get deltaTime(){return null!==this.lastFrameEndTime?Date.now()-this.lastFrameEndTime:0}draw(t){for(let e of this.pendulums)e.draw(t)}tick(t,e,s){for(let s of this.pendulums)s.wallCollision(t,e);for(let t of this.pendulums)t.move(s);for(let t of this.pendulums)t.update(s);let i=0;for(let t of this.pendulums)i+=t.speed.length;this.lastFrameEndTime=new Date}getRandomColor(){let t="#";for(let e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}start(t,e,s,i=!0){if(!e||!s)throw new Error("Canvas or ctx undefined");this.interval=setInterval((()=>{i&&function(t,e){e.clearRect(0,0,t.width,t.height)}(e,s),this.tick(e.width,e.height,1e3/t),this.draw(s)}),t)}stop(){clearInterval(this.interval)}}({pendulums:[]});(class{static chain(t){for(let e=0;e<t.length-1;e++)t[e].centers.push(t[e+1]);t[t.length-1].centers.push(t[0])}static eachOther(t){for(let e of t)e.centers=t}}).eachOther(o.pendulums),function(t,e){let s=document.getElementById("mass"),r=document.getElementById("size"),n=null;t.addEventListener("mousedown",(t=>{n={x:t.offsetX,y:t.offsetY}})),t.addEventListener("mouseup",(t=>{const o={x:t.offsetX-n.x,y:t.offsetY-n.y};e.pendulums.push(new h(n.x,n.y,Number(r.value),Number(s.value)*Math.pow(10,14),{color:e.getRandomColor(),centers:e.pendulums,speed:new i(o.x,o.y)}))}))}(r,o),o.start(1,r,n,!0)})();